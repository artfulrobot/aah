@import 'lib';

// This file whips CiviCRM's old classes into shape.
// Note: content generated by CiviCRM is not confined to #crm-container (as I had imagined from the name).

// A helper js snippet in this theme will inject certain classes on the body element
// - aah-theme
// - path: e.g. civicrm-contact-view
// - page: e.g. crm-case-page-tab

// General {{{
#crm-container {
  padding-top: 1.6rem;
  padding-left: 1.6rem;
  padding-right: 1.6rem;

  // Not sure about this !important
  font-size: $font-size-base !important;


  h1.page-header {
    display:none; // CiviCRM seems to output this anyways.
  }

  // Don't limit width in CiviCRM since it uses background-color on some headings which then look odd.
  h3, h4, h5 { max-width:none; }
}

// jQuery modals are not inside #crm-container.
body>.ui-dialog.crm-container {
  font-size: $font-size-base !important;
}

.crm-contaner {
  // Insist on our own colour links within a CiviCRM container.
  a,
  a:visited { color: $colourArtfulBrightBlue; }
  a:hover { color: $colourArtfulDarkBlue; }
}

// Provide some space at sides and assume a 1200px max by default.
// This is really annoying: the page is rendered before
body.aah-theme {
  h1#page-title,
  #crm-main-content-wrapper,
  #access
  {
    max-width: 1200px;
    margin-left:auto;
    margin-right:auto;
  }
}
//#crm-main-content-wrapper>.ng-scope {
// }}}
// Mostly functional rules copied from civicrm.css (5.35) {{{

/* Use this class to hide text that should only be there for screen readers */
.sr-only {
   border: 0;
   clip: rect(1px, 1px, 1px, 1px);
   clip-path: inset(50%);
   height: 1px;
   width: 1px;
   margin: -1px;
   overflow: hidden;
   padding: 0;
   position: absolute;
}

.crm-container .crm-flex-box {
  display: flex;
  flex-wrap: wrap;
  box-sizing: border-box;
}
.crm-container .crm-flex-box > * {
  flex: 1;
  box-sizing: border-box;
  min-width: 0; /* prevents getting squashed by whitespace:nowrap content */
}
.crm-container .crm-flex-box > .crm-flex-2 {
  flex: 2;
}
.crm-container .crm-flex-box > .crm-flex-3 {
  flex: 3;
}
.crm-container .crm-flex-box > .crm-flex-4 {
  flex: 4;
}
.crm-container .crm-flex-box > .crm-flex-5 {
  flex: 5;
}

.crm-container .crm-draggable {
  cursor: move;
}

#crm-container .hiddenElement,
.crm-container .hiddenElement {
  display: none;
}

#crm-container .clear,
.crm-container .clear {
  clear: both;
}
// }}}
// Full width pages {{{
// More efficient to list here.
%full-width-page {
  h1#page-title,
  #crm-main-content-wrapper,
  #access {
    max-width: none;
  }
  h1#page-title {
    padding-left: 1.6rem;
    padding-right: 1.6rem;
  }
}
// }}}
// Avoid Flash Of Unstyled Content {{{
body.page-civicrm #page-title, // Drupal specific!
.aah-wrapper {
  opacity: 0;
  transition: opacity 0.3s ;
}
body.aah-theme {
  #page-title,
  .aah-wrapper { opacity: 1; }
}
// }}}
// Page title {{{
// There's a chance this is specific to the Drupal 7 aaah theme, sorry about that.
body.aah-theme #header #page-title {
  margin: 0 1.6rem;
}
// }}}

// Override: Aaah theme! {{{
#crm-container li { max-width: none; }
// }}}
// Print stuff {{{
#printer-friendly,
.ui-button.crm-dialog-titlebar-print
{
  display:none; // It's never really printer friendly...
}
@media print {
  #civicrm-footer,
  #access,
  #civicrm-menu
  { display:none; }
  body.page-civicrm {
    padding-top:0;
  }
} // }}}

// Override: Mosaico. {{{
#bootstrap-theme .crm-mosaico-template-item {
  display:flex;
  width:100%;
}
#bootstrap-theme .crm-mosaico-template-item .crm-mosaico-template-title-wrapper {
  height:unset;
  flex: 1 0 160px;
}
#bootstrap-theme .crm-mosaico-template-item .crm-mosaico-template-image-wrapper {
  flex: 0 0 160px;
} // }}}
// Override: CiviCRM override default general styles {{{
#civicrm-menu, #root-menu-div ul,
.ui-widget {
  font-family: Lato;
}
.ui-widget {
  font-size:1em; // disable 1.1
}
// h3s are used throughout
.crm-container h3 {
  margin: 4rem 0 0.8rem;
  font-size: (32rem/16); // 20px
}
.crm-i-green {
  color: $colourGreenStrongBg;
}

.crm-i-red {
  color: $colourRedDanger;
}

.crm-i-blue {
  color: $colourArtfulDarkBlue;
}

#crm-container div#alpha-filter {
  background-color: $colourWidgetBackground;
  padding: 0.4rem 1.6rem;
}

// Remove extra icons not needed
.crm-action-menu::before {
  display: none;
}
// }}}
// Override: Bootstrap {{{
body.aah-theme {

  .label { color:inherit; }

  // Bootstrap says all .labels should be inline but CiviCRM uses the class on td...
  td.label {
    display: table-cell; // overrides bootstrap's 'inline-block'
    text-align: right; // overrides bootstrap's 'center'
    font-size: inherit; // bootstrap thinks all .labels should be 75% size.
    color: inherit; // bootstrap thinks all .labels should be white
  }

  // Tame headings in panels.
  .panel-heading {
    h1, h2, h3 { margin: 0; }
  }
}
// }}}
// Override: jQuery UI {{{
.ui-widget-header {
  background:$colourWidgetBackground;
  border:none;
}
.ui-state-default,
.ui-widget-content .ui-state-default,
.ui-widget-header .ui-state-default {
  background:$colourWidgetBackground;
  border:none;
  border-radius: 0;
  &:hover {
    background: $colourSubtleHoverLightBlueGrey;
  }
}
.ui-state-default a,
.ui-state-default a:link,
.ui-state-default a:visited,
a.ui-button,
a:link.ui-button,
a:visited.ui-button,
.ui-button {
  color: inherit;
  margin-right: 0;
  border: none;
}


.ui-state-active,
.ui-widget-content .ui-state-active,
.ui-widget-header .ui-state-active {
  background:$colourWidgetBackground;
  border:none;
  border-radius: 0;
  background: $colourWidgetSelectedBackground;
  &:hover {
    background: $colourSubtleHoverLightBlueGrey;
  }
  color: $colourArtfulBrightBlue;
  a:link, a:visited {
    color: $colourArtfulBrightBlue;
  }
}
.ui-state-hover,
.ui-widget-content .ui-state-hover,
.ui-widget-header .ui-state-hover,
.ui-state-focus,
.ui-widget-content .ui-state-focus,
.ui-widget-header .ui-state-focus,
.ui-button:hover,
.ui-button:focus {
  background: #127fd4; // @todo what colour?
  color: inherit;
  border: none;
}

.ui-state-active,
.ui-widget-content .ui-state-active,
.ui-widget-header .ui-state-active,
a.ui-button:active,
.ui-button:active,
.ui-button.ui-state-active:hover {
  background: #127fd4; // @todo what colour?
}

@keyframes aahblockoverlay {
  0% { background-color: $colourSubtleHoverLightBlueGreyTint; }
  50% { background-color: $colourBackground; }
  100% { background-color: $colourSubtleHoverLightBlueGreyTint; }
}
.crm-container .blockUI.blockOverlay {
  // background: url("../i/loading-overlay.gif") center center no-repeat white !important;
//  background-color: $colourBackground !important;
  animation: aahblockoverlay 10s infinite;
}

// The date picker widget has a fixed width, so we need to fix the padding or it does not fit.
.ui-datepicker th, .ui-datepicker td {
  // Feel ok about using !important here because this not something tht has the possiblity of nested elements.
  padding: 0 !important;
}
// }}}
// Override: Case {{{
.crmCaseType tr.addRow td {
  background: $colourSubtleHoverLightBlueGrey border-box !important;
}
// }}}
// Component: #access footer {{{
body.aah-theme #access {
  margin-top: 5rem;
}
// }}}
// Component: Actions ribbon (e.g. at top of Contact screen) and .action-link which seems to be very similar {{{
.crm-actions-ribbon {
  &>ul {
    margin: 1.6rem 0;
    padding: 0;
    li {
      list-style: none;
      display: inline-block;
      margin-right: 1.6rem;
    }
  }
}
.crm-actions-ribbon
.ac_results {
  // Until Javascript sets display: block, hide the actions popup.
  display: none;

  position: absolute;
  background: white;
  z-index: 10;
  width: 27rem;
  padding: 0.5rem 0;
  box-shadow: -1.6rem 1.6rem 3.2rem rgba(0, 0, 0, 0.2);

  ul {
    padding: 0;
    li {
      display:block;
      padding: 0;
      margin: 0;
      a {
        display: block;
        padding: 0.25rem 1rem;
        line-height: 1.2;
        &:hover {
          background: $colourSubtleHoverLightBlueGrey;
        }
      }
    }
  }
}
.action-link {
  margin: 1.6rem 0;
  a {
    margin-right: 1.6rem;
  }
}

//}}}
// Component: Accordions (various types). {{{

// Type 1: e.g. custom fields on contact summary form:
// div.crm-collapsible[[.collapsed]]
//   div.collapsible-title
//   div.crm-summary-block
//     div.crm-inline-edit ...

// Type 2:
// .crm-accordion-wrapper[[.collapsed]]
//   .crm-accordion-header[[.active]]
//   .crm-accordion-body


.crm-collapsible, // Type 1
.crm-accordion-wrapper { // Type 2
  margin-bottom: 1.6rem;
  margin-top: 1.6rem;

  border-bottom: solid 1px $colourFormElementsBorder;

  &:first-child {
    margin-top: 0;
  }
  &:last-child {
    margin-bottom: 0;
  }
}

.collapsible-title, // type 1
.crm-accordion-header { // type 2
  padding: 0.8rem 1.6rem 0.8rem 4rem;
  color: $colourArtfulDarkBlue;
  background-color: $colourBlueGrey;
  transition: background-color 0.2s;
  cursor: pointer;
}

.crm-accordion-header { // type 2 only
  &.active {
    background-color: mix($colourArtfulBrightBlueHigh, $colourArtfulBrightBlue, 50%);
    color: $colourArtfulDarkBlue;
  }
  &:hover, &.active:hover {
    background-color: mix($colourArtfulBrightBlueHigh, $colourArtfulBrightBlue, 50%);
  }
}

.collapsible-title::before, // type 1
.crm-accordion-header::before { // type 2
  content: "\F18E";
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  display: block;
  position: absolute;
  margin-left: -2.4rem;
  margin-top: 0.4rem;
  transition: transform 0.3s;
  transform: rotateZ(90deg);
}
.crm-collapsible>.crm-summary-block, // type 1
.crm-accordion-body { // type 2
  background: $colourLayeredBackground;
  padding: 1.6rem;
  border-radius: 0;
  border:none;
  overflow: auto; // force it to encompass floated elements.
  transform: none;
  // nicer animation on the body
  opacity: 1;
  transition: opacity 0.3s;
}
// When collapsed:
.crm-collapsible.collapsed, // type 1
.crm-accordion-wrapper.collapsed { // type 2

  // Remove the bottom border (asit tends to look like an underline)
  border-bottom: none;

  // Use a subtle backcolor.
  .collapsible-title, // type 1
  .crm-accordion-header { // type 2
    background-color: $colourLayeredBackground;
    &:hover {
      background-color: mix($colourArtfulBrightBlueHigh, $colourArtfulBrightBlue, 50%);
    }
  }

  // no rotation on the arrow pointing right.
  .collapsible-title::before, // type 1
  .crm-accordion-header::before { // type 2
    transform: none;
  }

  &>.crm-summary-block, // type 1
  .crm-accordion-body { // type 2
    display: none;
    opacity: 0;
  }
}

// }}}
// Component: Buttons {{{

// Some buttons look like this (type1)
//
// span.crm-button[[.crm-i-button]]
//   i.crm-i
//   input[type=submit]
//
// Some like (type2)
//
// a.crm-button
//   span
//     i.crm-i
//     button text
//
// Some like this (type3)
//
// button.btn.crm-button
//   i.crm-i.fa-xxx
//   button text
//
// Some (event online registration page, type4)
//
// button
//   i.crm-i.fa-xxx
//   button text
//

// Generally, things that should look like buttons:
a.crm-button>span,
button.crm-button,
#crm-main-content-wrapper button, // type 4
input.crm-form-submit,
.crm-container input[type="button"],
.crm-container input[type="submit"] {
  display:inline-block;
  background: $colourArtfulBrightBlue;
  padding:0.4rem 1.6rem;
  border:none;
  border-radius: 3px;
  color:white;
  text-shadow: none;
  box-shadow: none;
  vertical-align: baseline;

  &:hover {
    background-color: darken($colourArtfulBrightBlue, 10%);
  }

  &.btn-secondary {
    background: $colourArtfulDarkBlue;
  }
  &[disabled] {
    opacity:0.35;
    pointer-events: none;
  }
}

span.crm-button {
  position: relative;
  margin-right: 1.6rem; // space before next button in a list of buttons.
  padding: 0; // apply padding to the button itself, not the container (which is not clickable)
  display: inline-block;

  i {
    position: absolute;
    pointer-events: none;
    color: white;
    line-height: 1;
    left: 1.2rem;
    // Center vertically
    top: 50%;
    transform: translateY(-0.88rem);
  }

  input.crm-form-submit,
  input[type="button"],
  input[type="submit"] {
    padding:0.4rem 1.6rem 0.4rem 3.2rem;
    box-shadow: none;
  }
}

a.crm-button {
  position: relative;
  margin-right: 1.6rem; // space before next button in a list of buttons.
  padding: 0; // apply padding to the button itself, not the container (which is not clickable)
  display: inline-block;
  &.crm-button:link,
  &.crm-button:active,
  &.crm-button:visited,
  &.crm-button:hover
  { text-decoration:none; }

  // &>span  much of this is above.
  &>span { padding-left: 3.6rem; }

  i {
    position: absolute;
    pointer-events: none;
    color: white;
    line-height: 1;
    left: 1.2rem;
    // Center vertically
    top: 50%;
    transform: translateY(-0.88rem);
  }
}

// Angular buttons specify an icon on the button with the crm-icon attr.
// button.crm-button[crm-icon] { }

// Link buttons
.crm-container a.button,
.crm-container a.button:link,
.crm-container a.button:visited,
.crm-container .ui-button,
.crm-container .ui-dialog-buttonset .ui-button
{
  display:inline-block;
  padding:0.4rem 1.6rem;
  background: $colourArtfulBrightBlue;
  border:none;
  border-radius: 3px;
  color:white;
  text-shadow: none;
  box-shadow: 0 0 6px rgba(0,0,0,0.2);

  &:active,
  &:hover {
    background-color: darken($colourArtfulBrightBlue, 10%);
    text-decoration: none;
  }
}
// Sets of buttons.
.crm-inline-button,
.crm-submit-buttons {
  margin-bottom: 1.6rem;
  margin-top: 1.6rem;
  button.crm-button,
  span.crm-button,
  a.crm-button { margin-right: 1.6rem; }
}
// Remove top margin from buttons when they're the first child of a td
td>.crm-submit-buttons:first-child {
  margin-top: 0;
}

// Buttons in title bars.
.ui-dialog-titlebar {

  .ui-dialog-titlebar-close, // This class is mis-used for various types of button.
  button, span.ui-button {
    border-radius: 5px;
    background: transparent;
    border: solid 1px $colourArtfulBrightBlue;
    color: $colourArtfulBrightBlue;
    box-shadow: none;
    width: 2.56rem; // There's inline style attribute applied forcing positioning, so this is as wide as we can go.
    padding: 0;

    &:hover {
      background: rgba(255, 255, 255, 0.5);
      border: solid 1px $colourArtfulBrightBlue;
    }
  }
}

// 'more' buttons {{{
.btn-slide {
  position: relative;
  cursor:pointer;

  .panel {
    display: none;
    position: absolute;
    right: 0;
    width: 24rem;
    padding: 0;
    margin: 0;
    background: white;
    box-shadow: 0 0 6px rgba(0, 0, 0, 0.2);
    z-index: 1;
    li {
      list-style: none;
      font-size: 1.4rem;
      padding: 0;
      a {
        display: block;
        padding: 0.4rem 1.6rem;
        margin:0;
        text-decoration: none;
        &:hover {
          background: $colourSubtleHoverLightBlueGrey;
          text-decoration: none;
        }
      }
    }
  }
}
// }}}
// }}}
// Component: crm-hover-button {{{
// I think these can just be normal links, not sure what buttonising them does.
.crm-hover-button {
  display: inline-block;
  padding: 0 0.8rem;
  margin-right: 0.8rem;
}
// }}}
// Component: help {{{
.crm-container .help, .crm-container #help {
  padding: 1.6rem;
  border-radius: 0;
  border:none;
  background: $colourVeryLightBlue;
  border-left: 3.2rem solid $colourArtfulMutedBlue;
  font-size: 1.6rem;
  margin-bottom: 1.6rem;
  &::before {
    position: absolute;
    margin-left: -3.52rem;
    content: "\F0EB";
    font-size: 2rem;
    display: inline-block;
    font: normal normal normal 14px/1 FontAwesome;
    font-size: inherit;
    text-rendering: auto;
    color: white;
  }
}
// }}}
// Component: Fieldset inc. accordion fieldsets {{{
body.aah-theme fieldset {
  padding-top: 4.8rem;
  position: relative;

  &>legend {
    position: absolute;
    top: 0.8rem;
    left: 1.6rem;
    border-style:none;
  }

  &.crm-collapsible {
    background: $colourLayeredBackground;
    padding: 4.8rem 1.6rem 1.6rem;
    &.collapsed {
      background: transparent;
      padding: 4.8rem 0 0 0;
    }

    &>legend {
      top: 0;
      left: 0;
      font-size: inherit; // override bootstrap's 24px.
    }
  }
}
// }}}
// Component: form-block {{{
// This is used a lot. We give it a white background although often it's under
// another div which may have a semi-transparent background, so the white helps
// keep the colours nice.
// @see Contact Edit screen
.crm-form-block {
  background-color: white;
  padding: 1.4rem;
  // Sometimes (e.g. search form) these are nested.
  .crm-form-block {
    background: transparent;
    padding: 0;
  }
}
// }}}
// Component: Form elements {{{
// Note: crm-public-form-item
body.aah-theme {
  input[type="text"], input[type="password"], textarea {
    border-color: $colourFormElementsBorder;
    &.error  {
      border-color: $colourRedDanger;
    }
    margin-bottom: 0.2rem; // 2px - mainly to give some space to .crm-error which may follow.
  }
  .crm-error {
    background: $colourRedDanger;
    color: white;
    border-radius: 3px;
    display:inline-block;
    padding: 0.4rem 1rem;
  }


  // Clumsy spinner inputs {{{
  .ui-spinner input[type="text"] {
    border: none;
  }
  .ui-spinner-button {
    box-shadow: none;
    border-radius: 0;
    background: rgba(0,0,0,0.03);
  }
  // }}}

}
// Stop the labels butting right up against the tick boxes.
// Using padding so we don't create an unclickable gap.
.crm-form-checkbox,
.crm-form-radio {
  position: absolute;
  display: inline-block;

  // Except where this is the only element.
  &:last-child {
    position: static;
    display: inline-block;
  }

  &+label, &+.description {
    padding-left: 2.4rem;

    // The right margin pushes the next checkbox away from the label for the previous.
    margin-right: 2.4rem;
  }
}
// These sections are used (at least) in the angular page template to group fields togehter {{{
// They contain a div.label and a div.value.
.crm-section {
  display: flex;
  flex-wrap: wrap;
  margin-bottom: 1.6rem;

  // Apply a default child selector because not /all/ crm-sections contain simple label, content parts.
  // This should make everything except label, content parts behave like a normal block.
  &>* {
    flex: 0 1 100%;
  }

  &>.label {
    flex: 0 0 19.2rem;
    padding-right: 1.6rem;
    font-size: inherit;
    display: inline-block;
    text-align: right; // Bootstrap sets it center
    &,
    label { white-space: normal; } // Bootstrap says no wrap
  }
  // When we have label, content, label, content, put some space between them.
  &>.content + .label {
    margin-left: 3.2rem;
  }

  &>.content {
    flex: 1 0 19.2rem;

    //margin-right: 3.2rem;

    // Special treatment of radios, checkboxes.
    // 2021-05-05: This seemed to offer inline radios/checkboxes, but it really fails on mobile.
    // .crm-form-checkbox, .crm-form-radio {
    //   // Un-do the earlier rules
    //   position: static;
    //   display: inline-block;

    //   &+label {
    //     display: inline;
    //     margin-right: 6.4rem;
    //     padding-left: 0;
    //   }
    // }
  }
}

// Public forms, e.g. contribute.
// .crm-section inside public forms: keep things simple.
.crm-public-form-item .crm-section {
  display:block;
}
// Go back to blocks layout on mobile.
@media screen and (max-width: 767px) {
  .crm-profile-view .crm-section .label {
    text-align: left;
    flex: 0 0 100%;
  }
}


// }}}
.crm-form-date-wrapper {
  display: inline-block;
  &>input.crm-form-date { display:inline-block; }
  &>input.crm-form-date { width: 16rem; margin-right: 1.6rem; }
  &>input.crm-form-time { width: 9rem; }
}
// Date Picker elements use this
.crm-placeholder-icon::placeholder {
  font: normal normal normal 14px/1 FontAwesome;
}

// }}}
// Component: form-inline {{{
// Used in APIv4 explorer if nowhere else.
.form-inline {
  &>span { display: inline-block; vertical-align: baseline; }
}
// }}}
// Component: icon picker {{{
body.aah-theme a.crm-icon-picker-button {
  display: inline-block;
  min-width: 10em;
  height: 2.4rem;
  text-align: inherit;
  color: white;
}

#crmIconPicker a.ui-button {
  box-sizing: content-box;
  margin-bottom: 0.8rem;
  margin-right: 1.6rem;
  color: white !important;
}

body.aah-theme a.crm-icon-picker-button.ui-button-text-only .ui-button-text {
  padding: .4em .2em;
}


// }}}
// Component: progress bar for web queue runners {{{
.ui-progressbar-value {
  // normally it takes its colour from widget background
  background-color: $colourArtfulBrightBlue !important;
}
// }}}
// Component: various icons {{{
//.icon privacy-flag email-hold
.icon.email-hold {
  &::before {
    content:'\26d4'; // No Entry red sign
    display:inline-block;
    width: 2.4rem;
    height: 2.4rem;
    text-align:center;
  }
}
// }}}
// Component: sticky table heads. xxx probably want to tame this... {{{
// We limit this to the main content wrapper to exclude modals.
#crm-main-content-wrapper thead tr:first-child {
	position: sticky;
	top: 4.16rem;
	z-index: 20;
}
#crm-main-content-wrapper .crm-accordion-wrapper thead tr:first-child,
#crm-main-content-wrapper .crm-dashlet-content thead tr:first-child {
  position: static;
  top: 0;
}
// }}}
// Component: Notifications - non popups {{{
div.status,
div.messages {
  background: $colourAmberLightBg;
  border: none;
  border-left: solid 3.2rem $colourAmberStrongBg;
  margin: 1.6rem 0;
  padding: 1.6rem;

  position: relative;

  &.error {
    background: $colourAmberLightBg;
    border-left-color: $colourRedDanger;
  }
  // Hide unsightly image icon.
  img[alt="status"] { display:none; }

}
div.message {
  .icon {
    position: absolute;
    top: 1.6rem;
    left: -3.2rem;
    width: 3.2rem;
    text-align: center;

    &::before {
      display: inline-block;
      content: "\F05A"; // Default icon
      font: normal normal normal 14px/1 FontAwesome;
      font-size: inherit;
      text-rendering: auto;
      color: white;
    }
    // &.inform-icon::before (default)
  }
}

// }}}
// Component: Notifications - popups {{{
#crm-notification-container {
  // Normally 25% but allow ourselves at least 20rem so 200px
  width: 25%;
	min-width: 20rem;

  color: $colourText;
  position: fixed;
  top: 4.8rem;
  right: 1.6rem;
  z-index: 100000;
}

#crm-notification-container div.ui-notify-message {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  border: none;
	box-shadow: -1.6rem 1.6rem 3.2rem rgba(0, 0, 0, 0.2);
  border-radius: 2px;
  padding: 0;

	background: $colourAmberStrongBg;

  h1 {
    grid-column: 2;
    grid-row: 1;
    color: black;
    font-size: 1.4rem;
    margin:0;
    padding: .32rem 0.5rem;
    font-weight: bold;
  }

  // Close button
  a.ui-notify-cross {
    grid-column: 3;

    float: none;
    font-size: 1.6rem;
    text-shadow: none;
    padding: 0.4rem 1rem 0.5rem; // desperate attempt to vertically centre an x
    color: white;
    border: none;
    border-radius: 2px;
    text-decoration: none;
    line-height: 1.3;

    &:hover, &:active {
      background: rgba(255, 255, 255, 0.2);
      text-decoration: none;
    }
  }

  .notify-content {
    grid-column: 1/4;
    padding: 1rem 1.4rem;
    font-size: 1.4rem;
    background: white;
    padding:0.25rem 0 0.25rem 0.7rem;
  }

  &.success { background: $colourGreenStrongBg; }
  &.error {
    background: $colourRedDanger;
    h1 { color: white; }
  }
}


// The ticks and other icons...
body.aah-theme div.ui-notify-message div.icon, .crm-status-icon {
	margin-right: 0; // override
  text-indent: 0;
  float:none;

  &::before {
    content:'\26A0';// Warning sign.
    content:'\270b'; // Hand up emoji
    display:block;
    width: 2.4rem;
    height: 2.4rem;
    text-align:center;
    color: white;
  }
}
body.aah-theme div.ui-notify-message.success div.icon, .crm-status-icon.success {
  &::before { content:'\2714'; } // Tick.
}

// }}}
// Component: Notifications - angular ajax {{{
// div.crm-status-box-outer[.status-success] (this seems to have its opacity managed by js)
//   div.crm-status-box-inner
//     div.crm-status-box-msg
.crm-status-box-msg {
  color: white;
}
.crm-status-box-outer {
  position: fixed;
  top: 2px;
  right: 2px;
  z-index: 100000;
  background: $colourArtfulBrightBlue;
  padding: 0.8rem 1.6rem;
  border-radius: 3px;
  min-width: 12.8rem;
  max-width: 20.8rem;
  text-align: left;
  font-size: 1.4rem;

  &.status-success {
    background: $colourGreenStrongBg;
    .crm-status-box-msg { color: white; }
  }
  &.status-error {
    background: $colourRedDanger;
    .crm-status-box-msg { color: white; }
  }
}
// Spinner for notifications .status-start notifications e.g. loading/saving.
.crm-status-box-outer.status-start .crm-status-box-inner {
  // Allow space for spinner.
  padding-left: 2.5ch;
}
// The spinner.
.crm-status-box-outer.status-start .crm-status-box-inner::before {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  margin-left: -2.5ch;
  display: block;
  content:'';
  line-height: 1;
  animation: loading-status-message 1s infinite;
  transform-origin: center;
  width: 1.5ch;
  height: 1.5ch;
  border: dashed 1px white;
  border-radius: 2ch;
}
@keyframes loading-status-message {
  0% { transform:translateY(-50%); }
  100% { transform: translateY(-50%) rotateZ(360deg); }
}
// }}}
// Component: Radio inputs in [public] Profile forms {{{
.crm-profile .radio-wrapper { display:block; }
// }}}
// Component: Select 2 {{{


// Public pages need to work on mobile but
// select 2 is fond of setting a too-wide px width
// So we have to overrule this with an ugly !important.
.crm-public-form-item .select2-container {
  width: 100% !important;
  // Prefer to keep it not fully 100% if we can help it.
  width: clamp(20rem, 100%, 35rem) !important;
}

//.select2-container-multi .select2-choices .select2-search-choice
//.select2-container-multi  .select2-search-choice
.select2-container .select2-choice,
.select2-container .select2-choices .select2-choice,
.select2-container .select2-choices .select2-search-choice {
	// background-color: $colourSubtleHoverLightBlueGrey;
	// background-color: $colourWidgetBackground;
	background-color: white;
	filter: none;
	background-image: none;
}
.select2-container .select2-choice .select2-arrow {
  width: 2.88rem;
	border-left: 1px solid #aaa;
  background-color: rgba(0,0,0,0.1);
  border-radius: 0;
	filter: none;
	background-image:none;
  text-align: center;
  b { width: 18px;display:inline-block; }
}
.select2-container .select2-choice,
.select2-container-multi .select2-choices {
  border-color: rgba(0,0,0,0.2);
  border-radius: 2px;
}
.select2-container .select2-choice abbr {
  top: 10px;
  right: 3.52rem;
}
.select2-container {
  min-width: 11.2rem;
}
.select2-container-multi {
  min-width: 22.4rem;
}
.select2-container .select2-choice {
  height: 3.6rem;
}
.select2-arrow,
.select2-chosen { padding: 0.4rem 0; }
.select2-container .select2-choice > .select2-chosen { margin-right: 3.2rem; }

// Row description is smaller secondary text
// it should be only shown when the drop-down is open.
.crm-select2-row-description {
  display:none;
}
.select2-results {
  // this inherits 1rem = 10px in bs3 which is waaay too small.
  font-size:1.4rem;
}
.select2-results .crm-select2-row-description {
  display: block;
  font-size: (19.2rem/16);
  color: $colourMidGrey;
}

// Highlighted item.
.select2-results .select2-highlighted {
  background-color: $colourSubtleHoverLightBlueGrey;
  color: black;
}

// When used with a bootstrap .form-control...
.form-control.select2-container {
  padding: 0;
  border:none;
  // BS3 sets a fixed height(!) for .form-control.
  height: unset;
}
// }}}
// Component: Summary links {{{
.crm-summary-link {
  display: inline-block;
  color: $colourArtfulDarkBlue;
  // width: 3.2rem; height: 3.2rem;
}

.crm-summary-link .crm-icon {
  // line-height: 3.2rem;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
}
.crm-summary-display_name {
  .crm-summary-link {
    width: 3.2rem;
    height: 3.2rem;
  }

  .crm-summary-link .crm-icon {
    line-height: 3.2rem;
  }
}

.crm-summary-link .crm-icon.Individual-icon::before {
  content: "\F2BD";
  display: inline-block;
}

.crm-summary-link .crm-icon.Organization-icon::before {
  content: "\F0F7";
  display: inline-block;
}
.crm-summary-link .crm-icon.Organization-subtype-icon::before {
  // fa-users
  content: "\f0c0";
  display: inline-block;
}

// Popup contact summary boxes
.crm-summary-link .crm-tooltip-wrapper {
  display: none;
  position: absolute;
  background: white;
  padding: 0 1.6rem;
  font-size: 1.6rem;
  z-index: 21;
  box-shadow: -1.6rem 1.6rem 3.2rem rgba(0, 0, 0, 0.2);
}

.crm-summary-link.crm-tooltip-active .crm-tooltip-wrapper {
  display: block;
}

// The table of info
table.crm-table-group-summary {
  td { padding:0; }
  .crm-section {
    margin-bottom: 1rem;

    &>.label {
      flex: 0 1 13rem;
      font-weight: normal;
      font-size: 1.3rem;
      text-align: left;
      margin: 0;
      padding: 0 1.6rem 0 0 ;
      color: $colourText;
    }
    &>.content {
      flex: 1 0 13rem;
      margin: 0;
    }
    .clear { display: none; } // We don't need this and it interferes with grid.
  }
}


// }}}
// Component: Footer {{{
#civicrm-footer {
  margin-top: 8rem;
  text-align: center;
  font-size: (19.2rem/16);
  opacity: 0.8;
}
// Component: "Status" bit in the footer {{{
.status {

  &.crm-error {
    background: $colourRedDanger;
    border-radius: 2px;
    padding: 0 0.8rem;
    margin:0 0.8rem;
    color:white;
    a:link, a:visited {
      color:white;
    }
  }
}
// }}}
//}}}
// Component: help icon {{{
a.helpicon {
  &::before {
    font: normal normal normal 14px/1 FontAwesome;
    font-size: inherit;
    text-rendering: auto;
    content: "\F059";
    display:inline-block;
    line-height: 1;
    text-align:center;
    color: $colourArtfulBrightBlue;
  }
}
// }}}
// Component: Access keys {{{
#access {
  margin-top: 1.6rem;
  font-size: (22.4rem/16);
}
// }}}
// Component: Tabs (e.g. Contributions/Recurring Contributions) {{{

// Override the styles for the li.

// Some other CSS highlights the active li
body.aah-theme .ui-tabs .ui-tabs-nav li {
  border-bottom: solid 2px transparent;
}
body.aah-theme .ui-tabs .ui-tabs-nav li.ui-state-active {
  background: transparent;
  border-bottom-color: $colourArtfulBrightBlue;
}

// This is the actual clickable tab:
body.aah-theme .crm-tab-button a,
body.aah-theme .ui-tabs .ui-tabs-nav li a
{
  padding: 0.8rem 1.6rem; // we have to use important because we're overriding another !important(!)
  em  {
        background: $colourArtfulBrightBlue;
        border-radius: 0.8rem;
        font-size: (20.8rem/16);
        padding: 0 0.48rem;
        color:white;
        font-style:normal;
        font-weight:bold;
        &:empty { display: none; }
  }
}
// @todo specify that ul!
body.aah-theme ul li.crm-tab-button {
  &.ui-state-active {
    background: none;
    border-bottom: solid 2px $colourArtfulBrightBlue;
  }
  // Bit of spacing before the count number.
  em {
    margin-left: 1.6rem;
    display: inline-block;
  }
}

// Bootstrap tabs.
.panel-heading.nav-tabs {
  // Remove margin when used as a panel heading as it causes an unsightly white bit.
  margin-top:0;
}
// }}}
// Component: tables {{{
body.aah-theme table {
  border-collapse: collapse;
  width: 100%;

  td, th {
    padding: 0.8rem 1.6rem;
    background-clip: padding-box; // Stop Firefox drawing backgrounds over borders.
  }
  td {
    border: solid 1px $colourWidgetBorder;
  }
  thead {
    th {
      background-color: $colourSubtleHoverLightBlueGrey;
      border: solid 1px $colourSubtleHoverLightBlueGreyTint;
    }
  }
  tbody {
    th {
      background-color: mix($colourSubtleHoverLightBlueGrey, white);
      border: solid 1px mix($colourSubtleHoverLightBlueGreyTint, white);
    }
  }
}
body.aah-theme .cke_dialog_container table {
  width: auto;
  td, th { padding: 0 0.5rem; }
  td { border: none; }
}
// When tables are on a background colour, we need to differentiate them.

body.aah-theme .crm-accordion-wrapper table {
  background-color: rgb(255, 255, 255, 0.9);
}

// }}}
// Component: table.form-layout {{{
body.aah-theme table.form-layout {
  width: 100%;
  th, td {
    padding: 0.4rem 0.8rem;
    border:none;
  }
} // }}}
// Component: table.form-layout-compressed {{{
body.aah-theme table.form-layout-compressed {
  width: 100%;
  th, td {
    padding: 0.4rem 0.8rem;
    border:none;
    font-size: (22.4rem/16);
  }
}
// }}}
// Component: table selector {{{
body.aah-theme table.selector {
  width: 100%;
  tr.disabled td {
    // Nb. applying opacity here caused inaccessible 'more' menus. See issue https://github.com/artfulrobot/aah/issues/17

    // Faded text.
    color: #aaa;
    // Also fade 'pre' boxes, e.g. scheduled jobs page.
    pre {
      opacity: 0.5;
    }
  }

  th,
  td {
    padding: 0.4rem 0.8rem;
    border: none;
    font-size: 1.4rem;

    &> .crm-form-checkbox {
      position: static;
    }
  }
}


// }}}
// Component: table crm-info-panel {{{
// These are layout tables where each row is a separate table (gee, thanks).
body.aah-theme table.crm-info-panel {
  // Reduce vertical margins as these are often presented in a list.
  margin: 0.25rem 0;

  td, th { border: none; }

  td.label {
    font-size: inherit;
    text-align: right;
    font-weight: normal;
    width: 16rem;
    white-space: normal; // override bootstrap
  }
}
// }}}
// Component: data tables {{{
.dataTables_wrapper {
  // Idea: At least let them scroll on mobile...
  // overflow: auto;
  // Reality: doing this makes something odd happen, and hides the first row!
  // Better to apply it to the container.
}
.dataTables_wrapper .dataTables_paginate .paginate_button {
  padding: 0 0.8rem;
  &.current,
  &.current:hover {
    border:none;
    border: solid 1px $colourArtfulBrightBlue;
    background-color: $colourVeryLightBlue;
    background-image: none;
  }
}
// Make the alternate row shading more subtle.
.crm-container .odd-row, .crm-container .odd, tbody.scrollContent {
  background-color: $colourWidgetBackground;
}
.crm-container .even-row, .crm-container .even, tbody.scrollContent tr.alternateRow {
	background-color: $colourWidgetBackgroundLightest;
}
.crm-container table.row-highlight tr.even-row:hover, .crm-container table.row-highlight tr.even:hover, .crm-container .even-row.crm-row-selected, .crm-container .even.crm-row-selected,
.crm-container table.row-highlight tr:hover, .crm-container .crm-row-selected {
  background-color: $colourSubtleHoverLightBlueGrey;
}
.crm-container .crm-row-selected {
  background-color: $colourAmberLightBg;
}
// }}}
// Component: wysiwyg editor widgets {{{
.replace-plain {
  background: $colourLayeredBackground;
  border: solid 1px $colourWidgetBorder;
  padding: 1rem;
  cursor: pointer;
  font-size: 1.4rem; // smaller
  &::before {
    display:block;
    content: "\f040  " attr(title);
    white-space: pre; // otherwise we lose the space after the icon.
    font: normal normal normal 14px/1 FontAwesome;
    text-rendering: auto;
  }
}
// }}}
// Component: Matt’s checksum extension {{{
// Flex does not work here.
#Checksum > div > div.crm-section {
  display: block;
}
// }}}
// Component? Inline edit {{{
.crm-inline-edit.form {
  position: fixed;
  background: white;
  top: 50%;
  transform: translateY(-50%);
  left: 4rem;
  right: 4rem;
  height: auto;
  z-index: 2;
  // This creates a modal-like impression.
  box-shadow: 0 0 0 100vw rgba(255,255,255,0.9);
  overflow: auto;
  outline: $colourArtfulBrightBlue solid 1px;
}
// @todo make the tiny things like editing an activity subject bigger.
.crm-editable>.crm-editable-form {
}
// }}}
// Functional class: hiddenElement {{{
// Used on the main CiviCRM dashboard page, not sure if it has more general use.
body.aah-theme .hiddenElement { display: none; }
// }}}
// Functional class: .prettyprint {{{
// Used on the APIv4 explorer
.prettyprint {
  white-space: pre-wrap;
}
// }}}

// Quicksearch results {{{
ul.crm-quickSearch-results {
  font-size: 1.4rem;
  // Unhelpfully, jQueryUI sets a 200px width on this using style="", which is not big enough.
  // We override this by allowing overflow on the ul and setting a width on the li.
  overflow: visible;
  border:none;

  a {
    padding: 0.25rem 1rem;
    &:hover, &:focus {
      text-decoration: none;
    }
  }
  // Override jQueryUI rule: .ui-menu .ui-state-focus, .ui-menu .ui-state-active
  &.ui-menu {
    .ui-menu-item-uiMenuItemWrapper.ui-state-active {
      // Override the odd -1px margin applied on hover.
      margin:0;
    }
  }
}
// }}}
// Specific Page: Admin overview {{{
#id_Customize_Data_and_Screens_show,
#id_Communications_show,
#id_Localization_show,
#id_Users_and_Permissions_show,
#id_System_Settings_show,
#id_CiviContribute_show,
#id_CiviMail_show,
#id_CiviCase_show,
#id_CiviReport_show,
#id_CiviCampaign_show,
#id_CiviMember_show,
#id_CiviEvent_show,
#id_Customize_Data_and_Screens,
#id_Communications,
#id_Localization,
#id_Users_and_Permissions,
#id_System_Settings,
#id_CiviContribute,
#id_CiviMail,
#id_CiviCase,
#id_CiviReport,
#id_CiviCampaign,
#id_CiviMember,
#id_CiviEvent
{
  background: white;
}
// }}}
// Specific Page: Advanced Search {{{
body.aah-theme.crm-name-advanced {
  @extend %full-width-page;
}
// }}}
// Specific Page: APIv4 explorer {{{
.aah-theme.crm-name-crm-api4-page-api4explorer {
  // Allow full width page.
  #crm-main-content-wrapper {
    max-width: none;
  }

  // Fix issue where the checkbox hits the left border
  .checkbox-inline {
    padding-left: 4rem;
  }

}
// override some very specific styling in api4.css
.aah-theme #bootstrap-theme.api4-explorer-page {

  .explorer-params-panel .panel-heading {
    padding: 0.5rem 1rem;
    .form-inline {
      display: flex;
      gap: 1rem; // modern!
      &>* {
        flex: 1 1 auto;
      }
      button {
        // Override -5px;
        top: 0;
      }
    }
  }

  fieldset {
    padding-top: 3rem;
    crm-api4-clause:first-child { margin-top: -3rem; }
    legend { padding: 0; }
  }


}
// Specific Page: Mailings Draft and Unscheduled {{{
// The HTML for the top of this is truly hideous. So the css is hacky.
form.CRM_Mailing_Form_Search > .crm-search-form-block > table > tbody td:first-child {
  min-width: 45%;
}


// }}}
// Specific Page: Mosaico templates {{{
// The purpose of this is to format the thumbnail list of templates.
// By default the name of the thumbnail has to fit in 160px width, which
// doesn't work when you have long titles, especially important if using
// the mosaic message templates extension where the title also includes
// the template subject.
.mosaico-templates-wrapper // increase specificity
{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(50rem, 1fr));
  grid-gap: 2rem;
  span.thumbnail.crm-mosaico-template-item {
    float:none;
    width: 100%;
    display: grid;
    grid-template-columns: 165px 1fr; // fixed thumbs, auto
  }
  div>.crm-mosaico-template-item {
    float:none;

    .crm-mosaico-template-actions-wrapper a.btn {
      padding: 0.5rem 1rem;
    }

    .crm-mosaico-template-title-wrapper {
      text-align: left;
      height: unset;
      padding: 1.6rem;
      p {
        position: static;
        transform: none;
        width: auto;
      }
    }
  }
}
// }}}

// This affects a lot, including the content pane of tabbed content.
.ui-widget-content {
  border-color: $colourWidgetBorder;
  background: $colourWidgetBackground;
  background: white;
}


// I don't know why but CiviCRM sets a -10px margin on this that we have to undo.
#crm-container div.crm-summary-contactname-block {
  margin-top:0;
}



// @todo comments
.crmMailing .preview-popup, .crmMailing .preview-contact, .crmMailing .preview-group {
  height:9.6rem;
}

.crm-tag-item {
	line-height: 1.25;
	white-space: nowrap;
  display: inline-block;
	border: solid 1px rgba(0,0,0,0.2);
	border-radius: 3px;
	padding: 0 1rem;
	margin-right: 1rem;
	background: $colourVeryLightBlue;
	font-size: 1.4rem;
}

// The default font size for data on contact screens etc. is 11px!
.crm-container div.crm-clear {
  font-size:inherit;
}


.crm-container input { box-sizing: border-box; }


#secondaryTabContainer {
  border:none;
  padding:0;
}
// }}}
// Specific Page: Contact page {{{

// Give full page width to the view.
body.aah-theme.civicrm-contact-view {
  @extend %full-width-page;

  table.dataTable {
    font-size: 1.5rem; // sligntly smaller (worth it?)
  }
}
.crm-summary-display_name {
  margin-top:1.6rem;
  font-size: (43.2rem/16);
  color: $colourArtfulDarkBlue;
}
// Inline clickable edit things {{{
.crm-inline-edit {
  position: relative;

  // The edit forms within:
  .crm-container-snippet {
    padding: 0 1rem;
    background:white;
    overflow: auto;
    max-width: 100%;
    max-height: calc(100vh - 10rem);
  }

  // content that comes up when you hover over an editable chunk of the contact page.
  .crm-edit-help {
    display:none;
    position: absolute;
    top: -2.24rem;
    left: -1px;
    height: 2.24rem;
    background: $colourWidgetBackground;
    padding: 0 1.6rem;
    line-height: 2.24rem;
    border:solid 1px $colourArtfulBrightBlue;
    border-bottom-style:none;
  }

  &:hover {
    outline: $colourArtfulBrightBlue solid 1px;
    .crm-edit-help {
      display:block;
    }
  }

} // }}}
// Main tabs (make 'em vertical) {{{
.crm-contact-page #mainTabContainer {
  padding:0;
  border:none;

  // The tabs {{{
  .crm-contact-tabs-list {
    padding:0;
    background-color: $colourSubtleHoverLightBlueGrey;
    border-left: solid 1px rgba(0,0,0,0.1);
    margin: 0;
    border-radius: 0;
    // Start with mobile: tabs are in flex
    display: flex;
    flex-wrap: wrap;

    li.crm-tab-button {
      flex: 1 0 auto;
      margin:0 1.6rem 0 0;
      background:none;
      display:block;
      float:none;
      top:0;
      margin-right:0;

      &:first-child {
        border-top:none;
      }

      a { float:none; }
      // This would be an accessibility fail, but as it happens you can't tab through the tabs anyway...

      //&:not(.ui-tabs-active)
      border-bottom: solid 1px rgba(0,0,0,0.05);
    }
    // This is the <a> element
    .ui-tabs-anchor {
      display:flex;
      align-items: center;
      padding: 0.8rem 1.6rem;

      &:focus {
        outline: none;
      }

      i { flex: 0 0 1.92rem; }
      span { flex: 1 1 auto; padding-left:1em; font-size: (22.4rem/16); display:none; }
      // Item count in Contact tabs
      em {
        flex: 0 0 auto;
        background: $colourArtfulDarkBlue;
        background: $colourArtfulBrightBlue;
        border-radius: 0.8rem;
        font-size: (20.8rem/16);
        padding: 0 0.48rem;
        color:white;
        font-style:normal;
        font-weight:bold;
        margin-left: 0.5rem; // Reduce gap
      }
    }
    // Hide blob when there's a zero count
    .crm-count-, .crm-count-0 {
      em { display:none; }
    }
    // active / selected tab
    li.crm-tab-button.ui-state-active {
      background: $colourWidgetBackground; //xxx
      // border-bottom:none;
    }
    // active <a>
    li.crm-tab-button.ui-state-active .ui-tabs-anchor {
      background: $colourWidgetBackground;
      background: white;
      color: black;
      border-bottom:none;
      font-weight: bold;
    }
    li.ui-tabs-active {
      // Remove the -1px margin bottom added by jQueryUI
      margin-bottom:0;
    }
  } // }}}
  // The content
  .ui-tabs-panel {
    padding: 1.6rem;
  }
}
// Tablet+ moves tabs to the left {{{
@media screen and (min-width: 768px) {
  .crm-contact-page #mainTabContainer {
    display: grid;
    grid-template-columns: 8rem auto;
    .crm-contact-tabs-list {
      display:block; // disable flex now.
      li.crm-tab-button {
        margin: 0; // remove the 1.6rem right margin
        // The <a> element
        .ui-tabs-anchor {
          padding: 0.8rem 1rem;
        }
        a>span {
          display:block; // was 'none' for mobile.
        }
      }
    }
  }
}
// }}}

// Wide screens {{{
@media screen and (min-width: 1100px) {
  .crm-contact-page #mainTabContainer {
    grid-template-columns: 19.2rem auto;

    .crm-contact-tabs-list {
      li.crm-tab-button {
        white-space: normal; // For annoyingly long tab names.
        // The <a> element
        .ui-tabs-anchor {
          padding: 0.8rem 1.6rem;
        }
      }
    }
  }
}
// }}}
// pop-up tab text for intermediate screens {{{
@media screen and (min-width: 768px) and (max-width: 1099px) {

  .crm-contact-page #mainTabContainer {
    .crm-contact-tabs-list {
      li.crm-tab-button {
        position: relative;
        a>span {
          opacity: 0;
          transition: opacity 0.2s;
          position: absolute;
          background-color: $colourSubtleHoverLightBlueGrey;
          padding: 0.64rem 0.8rem;
          left: 4rem;
          top:0;
          bottom:0;
          width: 0;
          z-index: 1;
        }
        &:hover a>span {
          opacity: 1;
          width: 12.8rem;
        }
      }
    }
  }
}// }}}
 // }}}
// Contact summary tab {{{
.crm-container div.contact_panel {
  display:grid;
  grid-template-columns: 1fr;
  grid-gap: 1.6rem;
  margin-bottom: 1.6rem;
}
// Above mobile... {{{
@media screen and (min-width: 768px) {
  .crm-container div.contact_panel {
    grid-template-columns: repeat(2, minmax(24rem, 1fr));
  }
}
// }}}

// These containers split left and right sections.
// It's a shame really because it makes for uneven vertical gaps.
// To counter this we do a fake full height thing by setting the background colour.
#crm-container div.contactCardRight,
#crm-container div.contactCardLeft {
  flex: 1 0 19.2rem;
  width: auto;
  background: $colourWidgetBackground;
  border-left: solid 1px $colourWidgetBorder;
  // Keep all content at this height.
  // &>div, &>div>div, &>div>div>div { height: 100%; }
  &>div:first-child { margin-top: 0; }
  &>div:last-child { margin-bottom: 0; }
}
#crm-contact-thumbnail {
  float:right;
  padding: 1.6rem 1.6rem 0;
}
.crm-summary-block {
  margin-bottom: 1px;
}

// .crm-inline-block-content
//  .crm-summary-row
//    .crm-label
//    .crm-content
#contact-summary {

  .crm-inline-block-content {
    background: white;
    background: $colourWidgetBackground;
    padding:1.6rem;
  }
  .crm-inline-block-content,
  .crm-inline-edit-form {
    .crm-label {
      font-size: (22.4rem/16);
    }
  }
}

// This affects things like the fields on the contact summary page
div.crm-summary-row {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  margin-bottom: (8rem/16);

  .crm-label { flex: 0 0 12.8rem;  }
  .crm-content { flex: 1 0 12.8rem;  }

}

// Make the dividing line sharper and more subtle.
body.aah-theme .separator {
  border-bottom: solid 1px rgba(0,0,0,0.2);
}

// Email form contains extraneous column.
form#Email table.crm-inline-edit-form {
  td:last-child { display: none; }
  td[colspan]:last-child { display: table-cell; }
}

// Since we're absolutely positioning the inputs, we need this or they get a bit lost:
.crm-address-element {
  position: relative;
  display: inline-block;
  margin-right:2rem;
}

// Pop-up address editor

#Address_1 {
  // Without this our absolutely positioned checkboxes go weird if the content needs to scroll
  position: relative;

  // Try to force the lat, lon onto one line
  label[for="address_1_geo_code_1"] {
    width: 11ch;
  }
}
#address_1_geo_code_1, #address_1_geo_code_2 {
  display: inline-block;
  width: 10ch;
}

// }}}
// Contributions {{{
table {
  margin:1.6rem 0;
}
#crm-container th.contriTotalLeft,
#crm-container th.contriTotalRight {
  border:none;
}
// }}}
// Activity tab {{{
// Death to the table layout...
table.activity-search-options {
  tr { display: flex; flex-wrap: wrap; }
  td { flex: 1 0 19.2rem; display: block; }
}
table.contact-activity-selector-activity {
  // Scheduled
  tr.status-id-1 {
    color: $colourArtfulDarkBlue;
    &.status-overdue {
      color: $colourRedDanger;
    }

    // Make the Scheduled date bold if overdue, but don't apply this to the inline editor
    td.crmf-status_id>div:not(.crm-editable-editing) {
      font-weight: bold;

      &::before {
        display: inline-block;
        padding-right:0.7em;
        content: '⚠️';
      }
    }
  }
}
// }}}

// Component: Footer {{{
#crm-record-log {
  margin-top: 3.2rem;
  font-size: (19.2rem/16);
  opacity: 0.8;
  span { margin-right: 1.6rem; }
}
//}}}
// other tabs {{{
// }}}
// }}}
// Specific Page: Contact Export {{{
#crm-main-content-wrapper .crm-export-field-selector-outer thead tr:first-child {
  // Remove sticky applied above.
  position: static;
}
// }}}
// Specific Page: Dashboard {{{
// WIP: this replaces dashboard.css
body.aah-theme.crm-name-crm-contact-page-dashboard {
  @extend %full-width-page;
}
 // has own css, requires this specificity.
#crm-container #civicrm-dashboard {

  .col1-is-empty.col2-has-widgets>div,
  .col2-is-empty.col1-has-widgets>div {
    flex: 0 0 100%;
    min-height: 2rem;
  }
  // While editing dashboard, make the drop zones obvious.
  .droppable-live {
    border: solid 1px $colourArtfulBrightBlue;
    margin: 1rem 0;
    padding: 0.5rem;
  }

  h3.widget-header {
    // color: $colourText;
    color: $colourArtfulDarkBlue;
    font-size: 1.6rem;
  }

  .crm-inactive-dashlet-fieldset {
    legend {
      font-size: 1.6rem;
      background-color: transparent;
    }
  }

  // Overrides for 5.3x?+ dashboard.css
  .crm-dashlet {
    box-shadow: none;
  }
  // Nb. there is no way to tell if an accordion is open or closed in the angular version.
  .crm-dashlet-header {
    background-color: $colourBlueGrey;
    padding: 0 0.8rem;
    h3 {
      color: $colourArtfulDarkBlue;
      font-size: 1.6rem;
      padding: 0.8rem 1.6rem 0.8rem 0.8rem;
    }

    // crm-dashlet-collapse crm-i fa-caret-down
    a.crm-i {
      padding: 0.8rem;
      &::before {
        color: $colourArtfulDarkBlue;
      }
    }
    a.crm-dashlet-collapse {
      &::hover,
      &::focus {
        outline: none;
      }
      &::focus {
        color: white;
      }
      &::before {
        /* xxx */
        content: "\F18E";
        font: normal normal normal 14px/1 FontAwesome;
        font-size: 1.6rem;
        text-rendering: auto;
        display: block;
        transition: transform 0.3s;
        transform: rotateZ(90deg);
      }
      &.fa-caret-down::before {
        color: $colourArtfulDarkBlue;
      }
      &.fa-caret-right::before {
        content: "\F18E"; // Override
        transform: none;
        color: $colourArtfulDarkBlue;
      }
    }
  }

}
// }}}
// Specific Page: Events Config {{{
.CRM_Event_Form_ManageEvent_Registration {
  // We need to change the checkboxes (radios?) away from absolute since
  // this page puts a helpicon right by it.
  .crm-form-checkbox //, .crm-form-radio
  {
    position: static;
  }
}
// }}}
// Specific Page: Extensions {{{
// Hide the counts in <em> - they don't contain anything
.crm-container .ui-tabs .ui-tabs-nav.crm-extensions-tabs-list  li a em {
  display:none;
}
// }}}
// Specific Page: Case (new) {{{
// #crm-main-content-wrapper td.view-value input { display: block; content: ''; }

form#CaseView {
  table.case-summary {
    width: 100%;

    // Remove vertical margins on tables within tds
    .form-layout-compressed { margin:0; }
    .form-layout-compressed td { font-size: inherit; }

    // Remove bootstrap's .label styles
    td.label {
      font-size: inherit;
      text-align: left;
      font-weight: normal;
    }

    // Layout
    &>tbody>tr {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;

      &>td { flex: 0 0 auto; border: none; }
    }
  }
}
// }}}
// Specific Page: Case View {{{
body.civicrm-contact-view-case {
  @extend %full-width-page;
}
// }}}
// Specific Page: CiviMail {{{
body.aah-theme.crm-name-crm-mailing-page-browse {
  @extend %full-width-page;
}
// }}}
// Specific page: CiviRules {{{
body.aah-theme.crm-name-ruleview {
  @extend %full-width-page;
}
// }}}
// Specific page: Drupal user register form {{{
#user-register-form {
  #edit-civicrm-profile-register {
    input[type="text"] {
      border: solid 1px #eee;
    }
  }
}
// }}}
// Specific Page: Manage Groups {{{
body.aah-theme.crm-name-crm-group-page-group {
  @extend %full-width-page;
}
// }}}
// Specific Page: Membership renewal (admin form) {{{
// Issue 22. The help icon crashes into the absolutely positioned checkbox.
#is_different_contribution_contact {
  position: static;
}
//}}}
// Specific Page: Status {{{
.crm-status-item  {
  background: $colourLayeredBackground;
  margin-bottom: 1.6rem;

  &>h3 {
    margin:0;
    padding: 1rem 1.6rem;
    .css_right { float:right; }

  }
  .crm-status-message-body {
    padding: 1.6rem;
    margin: 0;
  }
}
// Override button colours.
#crm-status-list .hush-menu button {
  border: solid 1px white;
}
// }}}
// Sepecific Page: Search Kit {{{
body.crm-name-crm-search-page-admin.aah-theme #crm-main-content-wrapper {
  max-width: unset;
}
// Un-setting unhelpful SK CSS.
.aah-theme #bootstrap-theme.crm-search {

  // Un-set pixel width(!) in SK core.
  .api4-clause-badge { width: unset; }

  // SK overrides fieldset. Also it uses fieldset without a legend, where as
  // we assume fieldsets to have legends.

  // First, redefine default fieldsets (that use legends)
  fieldset {
    border-top: none;
    background: $colourLayeredBackground;
    // Reinstate our style - set to 6px, then again to 0px by crmSearchAdmin
    padding: 4.8rem 0.5rem 0.5rem 0.5rem;
    legend {
      position: absolute;
      top: 0.5rem;
      background: none;
      margin: 0;
      left: 0.5rem;
    }
  }

  // Next, allow for those without legends
 // fieldset.crm-search-criteria-column,
 // fieldset#crm-search-build-functions,
 // fieldset#crm-search-admin-debug
  //.crm-search-criteria-column>div>fieldset, // Matches the 'with's, but not the GroupBy, Where, Having (which use legend)
  // .crm-search-criteria-column:first-child>fieldset:last-child, // Matches the GroupBy.
  // .crm-search-admin-relative fieldset:not(.crm-search-admin-edit-columns fieldset):not(fieldset:last-child) // matches all fieldsets except the output column ones in Table edit.
  .xxx // This proved too hard to achieve; needs core patch to add some meaningful classes.
  {
    padding-top: 0.5rem;
  }

  fieldset.crm-draggable:nth-child(1) {
 display: flex;
 flex-wrap: wrap;
 align-items: flex-start;
}

  .crm-search-admin-edit-columns {
    fieldset {
       display: flex;
       flex-wrap: wrap;
       align-items: flex-start;
    }
    .form-inline {
      padding-right: 2rem;
      padding-bottom: 0.5rem;
    }
  }
  search-admin-display-table .form-inline {
    padding-bottom: 0.5rem;
  }
  search-admin-display-table .form-control {
    &.checkbox-inline, &.radio-inline {
      padding-left: 3rem;
    }
  }

  .crm-search-loading-placeholder {
    width: 100%; // why was it 80%?
    // height: 100%;
  }
}
.crm-search-admin-relative {
  // Leave space for the absolutely positioned View Results thing.
  padding-top:3.5rem;
}
// This is the container of most of the two columns (on wide screen)
.crm-search-admin-relative .crm-flex-box {
  gap: 1rem;
}
// The width of the Add field control is set by style attribute to 80px.
// The best we can do is fix font size so it's readable to those who squint.
.crm-search-display-table  th:last-child>.crm-action-menu {
  font-size: 12px;
}


// Provide a little space between the With...Entity .form-inline element and the 'ON' clause.
.api4-clause-fieldset {
  margin-top: 0.5rem;
  // background-color: $colourWidgetBackground;
  background: $colourLayeredBackground;
}


// }}}
// Sepecific Page: Form Builder {{{
body.aah-theme.page-civicrm-admin-afform {
  @extend %full-width-page;
}
#afGuiEditor .panel-heading ul.nav-tabs {
  // bootstrap uses float (yuk) for tabs.
  // so create block formatting context to avoid affecting later elements.
  overflow: auto;
  margin-top: 0.4em; // not sure if this will work in all contexts.
  &>li.active>a {
    background: white;
  }
}
// }}}
